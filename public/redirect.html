<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="robots" content="noindex, nofollow">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å¤•å¦æé†’æ‚¨</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        user-select: none;
        box-sizing: border-box;
      }
      :root {
        --main-site-background: #f7f9fe;
        --main-card-border: #e3e8f7;
        --main-card-background: #fff;
        --main-font-color: #363636;
      }
      @media (prefers-color-scheme: dark) {
        :root {
          --main-site-background: #18171d;
          --main-card-border: #3d3d3f;
          --main-card-background: #1b1c20;
          --main-font-color: #f7f7fa;
        }
      }
      a {
        text-decoration: none;
        color: var(--main-font-color);
      }
      body {
        background-color: var(--main-site-background);
        color: var(--main-font-color);
        font-family: "PingFang SC", "Open Sans", "Microsoft YaHei", sans-serif;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        width: 100vw;
        width: 100dvw;
        height: 100vh;
        height: 100dvh;
        overflow: hidden;
        transition:
          color 0.3s,
          background-color 0.3s;
      }
      header {
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      header .logo img {
        width: 100px;
        height: 100px;
        margin-bottom: 20px;
      }
      header .title {
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      header .title .site-name {
        font-size: 30px;
        font-weight: bold;
      }
      header .title .site-tip {
        font-size: 20px;
        margin-top: 8px;
        opacity: 0.6;
      }
      main {
        margin: 30px 20px 60px;
        border-radius: 16px;
        padding: 30px;
        max-width: 768px;
        min-width: 380px;
        background-color: var(--main-card-background);
        border: 1px solid var(--main-card-border);
      }
      main .tip {
        display: flex;
        justify-content: center;
        margin-bottom: 20px;
        opacity: 0.4;
      }
      main #url {
        display: block;
        padding: 12px 20px;
        border-radius: 8px;
        width: 100%;
        text-align: center;
        border: 1px solid var(--main-card-border);
        background-color: var(--main-site-background);
      }
      main #site-info {
        display: inline-flex;
        width: 100%;
        flex-direction: row;
        align-items: center;
        justify-content: center;
        margin-top: 20px;
        font-size: 18px;
      }
      main #jump-content.warn {
        color: #ffb02e;
      }
      main #jump-content.safe {
        color: #00d26a;
      }
      main #jump-content.danger {
        color: #f8312f;
      }
      main #jump-button {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 44px;
        width: 160px;
        margin: 30px auto 0;
        border-radius: 8px;
        color: var(--main-font-color);
        background-color: var(--main-card-border);
        transition: background-color 0.3s;
        cursor: pointer;
      }
      main #jump-button:hover {
        background-color: var(--main-site-background);
      }
      footer {
        width: 100%;
        text-align: center;
        position: absolute;
        bottom: 0;
        margin: 20px;
        opacity: 0.6;
        font-size: 15px;
      }
      footer .icp::before {
        content: "|";
        margin: 0 8px;
        margin-left: 4px;
        opacity: 0.2;
      }
    </style>
  </head>

  <body>
    <header>
      <div class="logo">
        <img src="./images/logo/logo.webp" alt="" />
      </div>
      <div class="title">
        <span class="site-name">Sy's Digital Garden</span>
        <span class="site-tip">å°å°å®‰å…¨æé†’</span>
      </div>
    </header>
    <main>
      <span class="tip">ğŸŒ¸ å¤•å¦è½»è½»æé†’ï¼šä½ è¦èµ°å‡ºèŠ±å›­å•¦ï¼Œå‰å¾€</span>
      <span id="url"></span>
      <div id="jump-content" class="warn">
        <span id="site-info">âš ï¸ è¿™ä¸ªç½‘å€è¿˜ä¸å¤ªç†Ÿæ‚‰å‘¢ï¼Œè®°å¾—ä¿æŠ¤å¥½è‡ªå·±å“¦ï½</span>
        <div id="jump-button">èµ°å§ï¼å»æ¢é™© âœ¨</div>
      </div>
    </main>
    <footer>
      <a class="power" href="https://chiyu.it/">
        Â©
        <script>
          document.write(new Date().getFullYear());
        </script>
        Sy's Digital Garden
      </a>
      <a class="icp" href="https://icp.gov.moe/?keyword=20259222" target="_blank"> èŒICPå¤‡20259222å· </a>
    </footer>
    <script>
      let jumpLink;
      let interval;
      const urlDom = document.getElementById("url");
      const urlTip = document.getElementById("site-info");
      const jumpContent = document.getElementById("jump-content");
      const jumpButton = document.getElementById("jump-button");

      const whitelist = [
        "*.chiyu.it",
        "gitee.com",
        "github.com",
        "*.baidu.com",
        "*.bing.cn",
        "npmjs.com",
      ];
      const blacklist = ["*.taobao.com", "*.jd.com"];

      const tipText = {
        safe: "ğŸŒ¿ è¿™æ˜¯å’±ä¿¡ä»»çš„å°ä¼™ä¼´ï¼Œå¯ä»¥æ”¾å¿ƒè¿‡å»å•¦ï½",
        danger: "ğŸš« å’±ä¸å»ºè®®å»é‚£é‡Œå‘¢ï¼Œå¯èƒ½æœ‰ç‚¹å±é™©â€¦",
      };

      const autoJump = () => {
        let count = 3;
        const updateContent = () => {
          jumpButton.innerHTML = `${count} ç§’åè‡ªåŠ¨è·³è½¬`;
          count--;
          if (count < 0) {
            clearInterval(interval);
            jumpButton.innerHTML = "å’»ï½å¸¦ä½ é£è¿‡å» ğŸ’«";
            window.location.replace(jumpLink);
          }
        };
        updateContent();
        interval = setInterval(updateContent, 1000);
      };

      const getJumpUrl = () => {
        try {
          const urlParams = new URLSearchParams(window.location.search);
          const encodedUrl = urlParams.get("url");
          jumpLink = atob(encodedUrl);
          urlDom.innerHTML = jumpLink;
          const urlHostname = new URL(jumpLink).hostname;

          for (let i = 0; i < blacklist.length; i++) {
            const blackPattern = blacklist[i].replace(/\*/g, ".*");
            if (urlHostname.match(blackPattern)) {
              urlTip.innerHTML = tipText.danger;
              jumpButton.innerHTML = "é‚£é‡Œæš‚æ—¶å»ä¸äº†å‘¢â€¦";
              jumpButton.style.cursor = "not-allowed";
              jumpButton.style.pointerEvents = "none";
              jumpButton.style.opacity = "0.4";
              jumpContent.className = "danger";
              return true;
            }
          }

          for (let i = 0; i < whitelist.length; i++) {
            const whitePattern = whitelist[i].replace(/\*/g, ".*");
            if (urlHostname.match(whitePattern)) {
              urlTip.innerHTML = tipText.safe;
              jumpContent.className = "safe";
              autoJump();
              return true;
            }
          }
        } catch (error) {
          console.error(error);
          jumpContent.remove();
          urlDom.innerHTML = "è·å–è·³è½¬é“¾æ¥å¤±è´¥";
        }
      };

      document.addEventListener("contextmenu", function (event) {
        event.preventDefault();
      });
      document.addEventListener("keydown", function (event) {
        if (event.keyCode === 123) {
          event.preventDefault();
        }
        if (
          event.ctrlKey &&
          event.shiftKey &&
          (event.keyCode === 73 || event.keyCode === 74 || event.keyCode === 67)
        ) {
          event.preventDefault();
        }
      });

      jumpButton.addEventListener("click", () => {
        clearInterval(interval);
        jumpButton.innerHTML = "å’»ï½å¸¦ä½ é£è¿‡å» ğŸ’«";
        if (jumpLink) window.location.replace(jumpLink);
      });

      window.addEventListener("DOMContentLoaded", () => {
        getJumpUrl();
      });
    </script>
  </body>
</html>
